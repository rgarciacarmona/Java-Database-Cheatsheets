<!DOCTYPE html>
<html>
<head>
<title>JPA Inheritance</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
/* GitHub stylesheet for MarkdownPad */
/* Author: Nicolas Hery - http://nicolashery.com */
/* Version: d5e7ce436666e7d4a2eeb12e7f8261dacceb3565 */
/* Source: https://github.com/nicolahery/markdownpad-github */

/* RESET
=============================================================================*/

html, body, div, span, applet, object, iframe, h1, h2, h3, h4, h5, h6, p, blockquote, pre, a, abbr, acronym, address, big, cite, code, del, dfn, em, img, ins, kbd, q, s, samp, small, strike, strong, sub, sup, tt, var, b, u, i, center, dl, dt, dd, ol, ul, li, fieldset, form, label, legend, table, caption, tbody, tfoot, thead, tr, th, td, article, aside, canvas, details, embed, figure, figcaption, footer, header, hgroup, menu, nav, output, ruby, section, summary, time, mark, audio, video {
  margin: 0;
  padding: 0;
  border: 0;
}

/* BODY
=============================================================================*/

body {
  font-family: Helvetica, arial, freesans, clean, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  color: #333;
  background-color: #fff;
  padding: 20px;
  max-width: 960px;
  margin: 0 auto;
}

body>*:first-child {
  margin-top: 0 !important;
}

body>*:last-child {
  margin-bottom: 0 !important;
}

/* BLOCKS
=============================================================================*/

p, blockquote, ul, ol, dl, table, pre {
  margin: 15px 0;
}

/* HEADERS
=============================================================================*/

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
}

h1 tt, h1 code, h2 tt, h2 code, h3 tt, h3 code, h4 tt, h4 code, h5 tt, h5 code, h6 tt, h6 code {
  font-size: inherit;
}

h1 {
  font-size: 28px;
  color: #000;
}

h2 {
  font-size: 24px;
  border-bottom: 1px solid #ccc;
  color: #000;
}

h3 {
  font-size: 18px;
}

h4 {
  font-size: 16px;
}

h5 {
  font-size: 14px;
}

h6 {
  color: #777;
  font-size: 14px;
}

body>h2:first-child, body>h1:first-child, body>h1:first-child+h2, body>h3:first-child, body>h4:first-child, body>h5:first-child, body>h6:first-child {
  margin-top: 0;
  padding-top: 0;
}

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0;
}

h1+p, h2+p, h3+p, h4+p, h5+p, h6+p {
  margin-top: 10px;
}

/* LINKS
=============================================================================*/

a {
  color: #4183C4;
  text-decoration: none;
}

a:hover {
  text-decoration: underline;
}

/* LISTS
=============================================================================*/

ul, ol {
  padding-left: 30px;
}

ul li > :first-child, 
ol li > :first-child, 
ul li ul:first-of-type, 
ol li ol:first-of-type, 
ul li ol:first-of-type, 
ol li ul:first-of-type {
  margin-top: 0px;
}

ul ul, ul ol, ol ol, ol ul {
  margin-bottom: 0;
}

dl {
  padding: 0;
}

dl dt {
  font-size: 14px;
  font-weight: bold;
  font-style: italic;
  padding: 0;
  margin: 15px 0 5px;
}

dl dt:first-child {
  padding: 0;
}

dl dt>:first-child {
  margin-top: 0px;
}

dl dt>:last-child {
  margin-bottom: 0px;
}

dl dd {
  margin: 0 0 15px;
  padding: 0 15px;
}

dl dd>:first-child {
  margin-top: 0px;
}

dl dd>:last-child {
  margin-bottom: 0px;
}

/* CODE
=============================================================================*/

pre, code, tt {
  font-size: 12px;
  font-family: Consolas, "Liberation Mono", Courier, monospace;
}

code, tt {
  margin: 0 0px;
  padding: 0px 0px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px;
}

pre>code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent;
}

pre {
  background-color: #f8f8f8;
  border: 1px solid #ccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px;
}

pre code, pre tt {
  background-color: transparent;
  border: none;
}

/* QUOTES
=============================================================================*/

blockquote {
  border-left: 4px solid #DDD;
  padding: 0 15px;
  color: #777;
}

blockquote>:first-child {
  margin-top: 0px;
}

blockquote>:last-child {
  margin-bottom: 0px;
}

/* HORIZONTAL RULES
=============================================================================*/

hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  border-bottom: 4px solid #ddd;
  padding: 0;
}

/* TABLES
=============================================================================*/

table th {
  font-weight: bold;
}

table th, table td {
  border: 1px solid #ccc;
  padding: 6px 13px;
}

table tr {
  border-top: 1px solid #ccc;
  background-color: #fff;
}

table tr:nth-child(2n) {
  background-color: #f8f8f8;
}

/* IMAGES
=============================================================================*/

.markdown-body img {
  max-width: 100%
}
</style>
<style type="text/css">
.highlight  { background: #ffffff; }
.highlight .c { color: #999988; font-style: italic } /* Comment */
.highlight .err { color: #a61717; background-color: #e3d2d2 } /* Error */
.highlight .k { font-weight: bold } /* Keyword */
.highlight .o { font-weight: bold } /* Operator */
.highlight .cm { color: #999988; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #999999; font-weight: bold } /* Comment.Preproc */
.highlight .c1 { color: #999988; font-style: italic } /* Comment.Single */
.highlight .cs { color: #999999; font-weight: bold; font-style: italic } /* Comment.Special */
.highlight .gd { color: #000000; background-color: #ffdddd } /* Generic.Deleted */
.highlight .gd .x { color: #000000; background-color: #ffaaaa } /* Generic.Deleted.Specific */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #aa0000 } /* Generic.Error */
.highlight .gh { color: #999999 } /* Generic.Heading */
.highlight .gi { color: #000000; background-color: #ddffdd } /* Generic.Inserted */
.highlight .gi .x { color: #000000; background-color: #aaffaa } /* Generic.Inserted.Specific */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #555555 } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #aaaaaa } /* Generic.Subheading */
.highlight .gt { color: #aa0000 } /* Generic.Traceback */
.highlight .kc { font-weight: bold } /* Keyword.Constant */
.highlight .kd { font-weight: bold } /* Keyword.Declaration */
.highlight .kp { font-weight: bold } /* Keyword.Pseudo */
.highlight .kr { font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #445588; font-weight: bold } /* Keyword.Type */
.highlight .m { color: #009999 } /* Literal.Number */
.highlight .s { color: #d14 } /* Literal.String */
.highlight .na { color: #008080 } /* Name.Attribute */
.highlight .nb { color: #0086B3 } /* Name.Builtin */
.highlight .nc { color: #445588; font-weight: bold } /* Name.Class */
.highlight .no { color: #008080 } /* Name.Constant */
.highlight .ni { color: #800080 } /* Name.Entity */
.highlight .ne { color: #990000; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #990000; font-weight: bold } /* Name.Function */
.highlight .nn { color: #555555 } /* Name.Namespace */
.highlight .nt { color: #000080 } /* Name.Tag */
.highlight .nv { color: #008080 } /* Name.Variable */
.highlight .ow { font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #009999 } /* Literal.Number.Float */
.highlight .mh { color: #009999 } /* Literal.Number.Hex */
.highlight .mi { color: #009999 } /* Literal.Number.Integer */
.highlight .mo { color: #009999 } /* Literal.Number.Oct */
.highlight .sb { color: #d14 } /* Literal.String.Backtick */
.highlight .sc { color: #d14 } /* Literal.String.Char */
.highlight .sd { color: #d14 } /* Literal.String.Doc */
.highlight .s2 { color: #d14 } /* Literal.String.Double */
.highlight .se { color: #d14 } /* Literal.String.Escape */
.highlight .sh { color: #d14 } /* Literal.String.Heredoc */
.highlight .si { color: #d14 } /* Literal.String.Interpol */
.highlight .sx { color: #d14 } /* Literal.String.Other */
.highlight .sr { color: #009926 } /* Literal.String.Regex */
.highlight .s1 { color: #d14 } /* Literal.String.Single */
.highlight .ss { color: #990073 } /* Literal.String.Symbol */
.highlight .bp { color: #999999 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #008080 } /* Name.Variable.Class */
.highlight .vg { color: #008080 } /* Name.Variable.Global */
.highlight .vi { color: #008080 } /* Name.Variable.Instance */
.highlight .il { color: #009999 } /* Literal.Number.Integer.Long */
.pl-c {
    color: #969896;
}

.pl-c1,.pl-mdh,.pl-mm,.pl-mp,.pl-mr,.pl-s1 .pl-v,.pl-s3,.pl-sc,.pl-sv {
    color: #0086b3;
}

.pl-e,.pl-en {
    color: #795da3;
}

.pl-s1 .pl-s2,.pl-smi,.pl-smp,.pl-stj,.pl-vo,.pl-vpf {
    color: #333;
}

.pl-ent {
    color: #63a35c;
}

.pl-k,.pl-s,.pl-st {
    color: #a71d5d;
}

.pl-pds,.pl-s1,.pl-s1 .pl-pse .pl-s2,.pl-sr,.pl-sr .pl-cce,.pl-sr .pl-sra,.pl-sr .pl-sre,.pl-src,.pl-v {
    color: #df5000;
}

.pl-id {
    color: #b52a1d;
}

.pl-ii {
    background-color: #b52a1d;
    color: #f8f8f8;
}

.pl-sr .pl-cce {
    color: #63a35c;
    font-weight: bold;
}

.pl-ml {
    color: #693a17;
}

.pl-mh,.pl-mh .pl-en,.pl-ms {
    color: #1d3e81;
    font-weight: bold;
}

.pl-mq {
    color: #008080;
}

.pl-mi {
    color: #333;
    font-style: italic;
}

.pl-mb {
    color: #333;
    font-weight: bold;
}

.pl-md,.pl-mdhf {
    background-color: #ffecec;
    color: #bd2c00;
}

.pl-mdht,.pl-mi1 {
    background-color: #eaffea;
    color: #55a532;
}

.pl-mdr {
    color: #795da3;
    font-weight: bold;
}

.pl-mo {
    color: #1d3e81;
}
.task-list {
padding-left:10px;
margin-bottom:0;
}

.task-list li {
    margin-left: 20px;
}

.task-list-item {
list-style-type:none;
padding-left:10px;
}

.task-list-item label {
font-weight:400;
}

.task-list-item.enabled label {
cursor:pointer;
}

.task-list-item+.task-list-item {
margin-top:3px;
}

.task-list-item-checkbox {
display:inline-block;
margin-left:-20px;
margin-right:3px;
vertical-align:1px;
}
</style>
</head>
<body>
<h1>JPA Inheritance</h1>
<p><em>Rodrigo Garc√≠a Carmona</em> (v1.1.3)</p>
<p>Relational databases don't feature object-oriented inheritance, so using super and subclasses with JPA can be tricky. There is no standard way to implement inheritance in a database, and therefore we must choose how we're going to represent this feature in the relational model.</p>
<p>JPA supports three inheritance models, defined trough the Inheritance annotation:</p>
<ul>
<li><strong>One table for all classes:</strong> <em>SINGLE_TABLE</em></li>
<li><strong>One table for each class:</strong> <em>JOINED</em></li>
<li><strong>One table for each subclass:</strong> <em>TABLE_PER_CLASS</em></li>
</ul>
<h2>Single Table Inheritance</h2>
<p>This is the default inheritance strategy used if none is specified. It's the simplest and typically the best performing solution... if you can tune your tables to add a discriminator column.</p>
<p>In this strategy, a single table is used to store all instances of the entire inheritance hierarchy. The table will have a column for every attribute of every class in the hierarchy and a discriminator column; used to determine which class the particular row belongs to. This column will contain a value specific to each class.</p>
<p>A single table looks like this:</p>
<p><strong>project</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>proj_type</th>
<th>name</th>
<th>budget</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>L</td>
<td>Marketing</td>
<td>5000.0</td>
</tr>
<tr>
<td>2</td>
<td>S</td>
<td>Legal</td>
<td>null</td>
</tr></tbody></table>
<p>And is implemented using these classes:</p>
<div class="highlight highlight-source-java"><pre><span class="pl-k">@Entity</span>
<span class="pl-k">@Inheritance</span>(<span class="pl-c1">strategy</span><span class="pl-k">=</span><span class="pl-smi">InheritanceType</span><span class="pl-c1"><span class="pl-k">.</span>SINGLE_TABLE</span>)
<span class="pl-k">@DiscriminatorColumn</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>proj_type<span class="pl-pds">"</span></span>)
<span class="pl-k">@ForceDiscriminator</span>
<span class="pl-k">@Table</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>projects<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">abstract</span> <span class="pl-k">class</span> <span class="pl-en">Project</span> {
	<span class="pl-k">@Id</span>
	<span class="pl-c"><span class="pl-c">//</span> Other Id annotations as needed</span>
	<span class="pl-k">private</span> <span class="pl-smi">Integer</span> id;
	<span class="pl-c1">...</span>
}

<span class="pl-k">@Entity</span>
<span class="pl-k">@DiscriminatorValue</span>(<span class="pl-s"><span class="pl-pds">"</span>L<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">LargeProject</span> <span class="pl-k">extends</span> <span class="pl-e">Project</span>, <span class="pl-k">implements</span> <span class="pl-e">Serializable</span> {
	<span class="pl-k">private</span> <span class="pl-smi">Double</span> budget;
}	

<span class="pl-k">@Entity</span>
<span class="pl-k">@DiscriminatorValue</span>(<span class="pl-s"><span class="pl-pds">"</span>S<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SmallProject</span> <span class="pl-k">extends</span> <span class="pl-e">Project</span>, <span class="pl-k">implements</span> <span class="pl-e">Serializable</span> {
}</pre></div>
<h2>One Table Per Class Inheritance</h2>
<p>This inheritance strategy is used when we have a relational model that closely follows the object model, so it's usually employed when the object model is designed first.</p>
<p>With this strategy, a table is defined for each class in the inheritance hierarchy, including the parent class. Each table only contains the attributes specific to the class it represents, and the parent class' table must contain a discriminator column, like in the single table strategy.</p>
<p>Each table must also store the object's primary key, but this is only defined in the root class. All classes in the hierarchy must share the same id attribute.</p>
<p>A set of tables for this strategy look like this:</p>
<p><strong>projects</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>proj_type</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>L</td>
<td>Marketing</td>
</tr>
<tr>
<td>2</td>
<td>S</td>
<td>Legal</td>
</tr></tbody></table>
<p><strong>smallprojects</strong></p>
<table>
<thead>
<tr>
<th>id</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
</tr></tbody></table>
<p><strong>largeprojects</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>budget</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>5000.0</td>
</tr></tbody></table>
<p>And are implemented using these classes:</p>
<div class="highlight highlight-source-java"><pre><span class="pl-k">@Entity</span>
<span class="pl-k">@Inheritance</span>(<span class="pl-c1">strategy</span><span class="pl-k">=</span><span class="pl-smi">InheritanceType</span><span class="pl-c1"><span class="pl-k">.</span>JOINED</span>)
<span class="pl-k">@DiscriminatorColumn</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>proj_type<span class="pl-pds">"</span></span>)
<span class="pl-k">@Table</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>projects<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">abstract</span> <span class="pl-k">class</span> <span class="pl-en">Project</span> {
	<span class="pl-k">@Id</span>
	<span class="pl-c"><span class="pl-c">//</span> Other Id annotations as needed</span>
	<span class="pl-k">private</span> integer id;
	<span class="pl-c1">...</span>
}

<span class="pl-k">@Entity</span>
<span class="pl-k">@DiscriminatorValue</span>(<span class="pl-s"><span class="pl-pds">"</span>L<span class="pl-pds">"</span></span>)
<span class="pl-k">@Table</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>largeprojects<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">LargeProject</span> <span class="pl-k">extends</span> <span class="pl-e">Project</span>, <span class="pl-k">implements</span> <span class="pl-e">Serializable</span> {
	<span class="pl-k">private</span> <span class="pl-smi">Double</span> budget;
}

<span class="pl-k">@Entity</span>
<span class="pl-k">@DiscriminatorValue</span>(<span class="pl-s"><span class="pl-pds">"</span>S<span class="pl-pds">"</span></span>)
<span class="pl-k">@Table</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>smallprojects<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SmallProject</span> <span class="pl-k">extends</span> <span class="pl-e">Project</span>, <span class="pl-k">implements</span> <span class="pl-e">Serializable</span> {
}</pre></div>
<h2>One Table Per Subclass Inheritance</h2>
<p>This inheritance strategy is used when we want to keep the relational model oblivious to it, since no discriminator column is required and each class is in a different, completely separated, table.</p>
<p>In this strategy, we use an abstract parent class and several children classes. Each child class is realized as a table that stores all the attributes of that class and the superclass.</p>
<p>Here's an example of a possible table structure:</p>
<p><strong>smallprojects</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
<td>Legal</td>
</tr></tbody></table>
<p><strong>largeprojects</strong></p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>budget</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Marketing</td>
<td>5000.0</td>
</tr></tbody></table>
<p>Which is implemented using these classes:</p>
<div class="highlight highlight-source-java"><pre><span class="pl-k">@Entity</span>
<span class="pl-k">@Inheritance</span>(<span class="pl-c1">strategy</span><span class="pl-k">=</span><span class="pl-smi">InheritanceType</span><span class="pl-c1"><span class="pl-k">.</span>TABLE_PER_CLASS</span>)
<span class="pl-k">public</span> <span class="pl-k">abstract</span> <span class="pl-k">class</span> <span class="pl-en">Project</span> {
	<span class="pl-k">@Id</span>
	<span class="pl-c"><span class="pl-c">//</span> No other Id annotations should be put here</span>
	<span class="pl-k">private</span> <span class="pl-smi">Integer</span> id;
	<span class="pl-k">@Column</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>)
	<span class="pl-k">private</span> <span class="pl-smi">String</span> name;
	<span class="pl-c1">...</span>
}

<span class="pl-k">@Entity</span>
<span class="pl-k">@Table</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>largeprojects<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">LargeProject</span> <span class="pl-k">extends</span> <span class="pl-e">Project</span>, <span class="pl-k">implements</span> <span class="pl-e">Serializable</span> {
	<span class="pl-k">@Id</span>
	<span class="pl-c"><span class="pl-c">//</span> Other Id annotations as needed</span>
	<span class="pl-k">private</span> <span class="pl-smi">Integer</span> id;
	<span class="pl-k">private</span> <span class="pl-smi">Double</span> budget;
	<span class="pl-c1">...</span>
}

<span class="pl-k">@Entity</span>
<span class="pl-k">@Table</span>(<span class="pl-c1">name</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>smallprojects<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SmallProject</span> <span class="pl-k">extends</span> <span class="pl-e">Project</span>, <span class="pl-k">implements</span> <span class="pl-e">Serializable</span> {
	<span class="pl-k">@Id</span>
	<span class="pl-c"><span class="pl-c">//</span> Other Id annotations as needed</span>
	<span class="pl-k">private</span> <span class="pl-smi">Integer</span> id;
	<span class="pl-c1">...</span>
}</pre></div>
</body>
</html>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->
